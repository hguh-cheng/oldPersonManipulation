<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Personalized News Website</title>
    <link rel="stylesheet" href="style.css" />
    <!-- Font Awesome for Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha384-eOIpuBfS45VEnlOOXczIDWQI0hNWQ4EaKQSNXqap3ONjCWra9jxfjkdrsLeGMRoK"
      crossorigin="anonymous"
    />
    <!-- Google Fonts for Geometric Typography -->
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@700&family=Montserrat:wght@600&display=swap"
      rel="stylesheet"
    />
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  </head>
  <body>
    <!-- Header Section -->
    <header>
      <div class="container">
        <div class="logo">
          <h1>The American Truth</h1>
        </div>
        <nav>
          <ul class="nav-links">
            <li><a href="#">Home</a></li>
            <li><a href="#">Topics</a></li>
          </ul>
        </nav>
        <div class="header-actions">
          <!-- Sign Up and Login Buttons -->
          <button id="signup-btn" class="auth-button">Sign Up</button>
          <button id="login-btn" class="auth-button">Login</button>

          <!-- Profile Icon (Hidden by Default) -->
          <div id="profile-icon" class="profile-icon" style="display: none">
            <a href="profile.html"><i class="fas fa-user-circle fa-2x"></i></a>
          </div>

          <!-- Dark Mode -->
          <button class="dark-mode-toggle" aria-label="Toggle dark mode">
            <svg
              class="sun-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="5"></circle>
              <path
                d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
              ></path>
            </svg>
            <svg
              class="moon-icon"
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
          </button>

          <!-- Notification Bell -->
          <div class="notification-bell">
            <a href="#"
              ><i class="fas fa-bell"></i
              ><span class="notification-count">3</span></a
            >
          </div>
        </div>
      </div>
    </header>

    <!-- Auth Modals -->
    <!-- Sign Up Modal -->
    <div id="signup-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-signup">&times;</span>
        <h2>Sign Up</h2>
        <form id="signup-form">
          <input type="email" id="signup-email" placeholder="Email" required />
          <input
            type="password"
            id="signup-password"
            placeholder="Password"
            required
          />
          <button type="submit">Sign Up</button>
          <p>
            Already have an account?
            <a href="#" id="switch-to-login">Login here</a>
          </p>
        </form>
        <div id="signup-error" class="error-message"></div>
      </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-login">&times;</span>
        <h2>Login</h2>
        <form id="login-form">
          <input type="email" id="login-email" placeholder="Email" required />
          <input
            type="password"
            id="login-password"
            placeholder="Password"
            required
          />
          <button type="submit">Login</button>
          <p>
            Don't have an account?
            <a href="#" id="switch-to-signup">Sign up here</a>
          </p>
          <p><a href="#" id="forgot-password">Forgot Password?</a></p>
        </form>
        <div id="login-error" class="error-message"></div>
      </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgot-password-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-forgot-password">&times;</span>
        <h2>Reset Password</h2>
        <form id="forgot-password-form">
          <input
            type="email"
            id="reset-email"
            placeholder="Enter your email"
            required
          />
          <button type="submit">Send Reset Link</button>
        </form>
        <div id="forgot-password-message" class="success-message"></div>
        <div id="forgot-password-error" class="error-message"></div>
      </div>
    </div>

    <!-- Main Content -->
    <main>
      <!-- Top Headlines Section -->
      <section class="top-headlines">
        <div class="container">
          <h2>Your Top 3</h2>
          <div class="headlines-grid">
            <article class="headline-item">
              <a href="article1.html">
                <div class="image-overlay">
                  <img src="images/article1.jpg" alt="Article 1" />
                  <div class="overlay-color"></div>
                </div>
                <h3>Article Title 1</h3>
              </a>
            </article>
            <article class="headline-item">
              <a href="article2.html">
                <div class="image-overlay">
                  <img src="images/article2.jpg" alt="Article 2" />
                  <div class="overlay-color"></div>
                </div>
                <h3>Article Title 2</h3>
              </a>
            </article>
            <article class="headline-item">
              <a href="article3.html">
                <div class="image-overlay">
                  <img src="images/article3.jpg" alt="Article 3" />
                  <div class="overlay-color"></div>
                </div>
                <h3>Article Title 3</h3>
              </a>
            </article>
          </div>
        </div>
      </section>

      <!-- Current Topics Section -->
      <section class="current-topics">
        <div class="container">
          <h2>Current Topics</h2>
          <div class="topics-tags">
            <a href="#" class="topic-tag finance">Finance</a>
            <a href="#" class="topic-tag technology">Technology</a>
            <a href="#" class="topic-tag health">Health</a>
            <a href="#" class="topic-tag entertainment">Entertainment</a>
            <a href="#" class="topic-tag sports">Sports</a>
          </div>
        </div>
      </section>

      <!-- Misc Content Section -->
      <section class="misc-content">
        <div class="container">
          <h2>Market Overview</h2>
          <div class="stock-data">
            <!-- Placeholder for stock data widgets or APIs -->
            <p>Stock Data Coming Soon...</p>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer Section -->
    <footer>
      <div class="container">
        <p>&copy; 2023 The American Truth. All rights reserved.</p>
      </div>
    </footer>

    <!-- Firebase Configuration and Authentication Script -->
    <script>
      // TODO: Replace the below configuration with your Firebase project's config object
      const firebaseConfig = {
        apiKey: "AIzaSyC7py7vzQy_pDNv7hX0_CY5bKkTcQAnZOI",
        authDomain: "YOUR_AUTH_DOMAIN",
        projectId: "americantruth",
        appId: "977694035764",
        // ... other config properties
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      // Modal Elements
      const signupModal = document.getElementById("signup-modal");
      const loginModal = document.getElementById("login-modal");
      const forgotPasswordModal = document.getElementById(
        "forgot-password-modal"
      );

      // Button Elements
      const signupBtn = document.getElementById("signup-btn");
      const loginBtn = document.getElementById("login-btn");
      const closeSignup = document.getElementById("close-signup");
      const closeLogin = document.getElementById("close-login");
      const closeForgotPassword = document.getElementById(
        "close-forgot-password"
      );
      const switchToLogin = document.getElementById("switch-to-login");
      const switchToSignup = document.getElementById("switch-to-signup");
      const forgotPasswordLink = document.getElementById("forgot-password");

      // Profile Icon
      const profileIcon = document.getElementById("profile-icon");

      // Error Message Elements
      const signupError = document.getElementById("signup-error");
      const loginError = document.getElementById("login-error");
      const forgotPasswordMessage = document.getElementById(
        "forgot-password-message"
      );
      const forgotPasswordError = document.getElementById(
        "forgot-password-error"
      );

      // Open Modals
      signupBtn.addEventListener("click", () => {
        signupModal.style.display = "block";
      });

      loginBtn.addEventListener("click", () => {
        loginModal.style.display = "block";
      });

      // Close Modals
      closeSignup.addEventListener("click", () => {
        signupModal.style.display = "none";
      });

      closeLogin.addEventListener("click", () => {
        loginModal.style.display = "none";
      });

      closeForgotPassword.addEventListener("click", () => {
        forgotPasswordModal.style.display = "none";
      });

      // Switch Between Sign Up and Login
      switchToLogin.addEventListener("click", (e) => {
        e.preventDefault();
        signupModal.style.display = "none";
        loginModal.style.display = "block";
      });

      switchToSignup.addEventListener("click", (e) => {
        e.preventDefault();
        loginModal.style.display = "none";
        signupModal.style.display = "block";
      });

      // Open Forgot Password Modal
      forgotPasswordLink.addEventListener("click", (e) => {
        e.preventDefault();
        loginModal.style.display = "none";
        forgotPasswordModal.style.display = "block";
      });

      // Handle Sign Up
      const signupForm = document.getElementById("signup-form");
      signupForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const email = document.getElementById("signup-email").value;
        const password = document.getElementById("signup-password").value;

        auth
          .createUserWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // Signed up successfully
            const user = userCredential.user;
            // Create a corresponding document in Firestore
            db.collection("users")
              .doc(user.uid)
              .set({
                engagementStreak: 0,
                badgesEarned: [],
                rankingPosition: null,
              })
              .then(() => {
                console.log("User document created in Firestore.");
              })
              .catch((error) => {
                console.error("Error creating user document:", error);
              });

            signupModal.style.display = "none";
            signupForm.reset();
            signupError.textContent = "";
          })
          .catch((error) => {
            signupError.textContent = error.message;
          });
      });

      // Handle Login
      const loginForm = document.getElementById("login-form");
      loginForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const email = document.getElementById("login-email").value;
        const password = document.getElementById("login-password").value;

        auth
          .signInWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // Logged in successfully
            loginModal.style.display = "none";
            loginForm.reset();
            loginError.textContent = "";
          })
          .catch((error) => {
            loginError.textContent = error.message;
          });
      });

      // Handle Forgot Password
      const forgotPasswordForm = document.getElementById(
        "forgot-password-form"
      );
      forgotPasswordForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const email = document.getElementById("reset-email").value;

        auth
          .sendPasswordResetEmail(email)
          .then(() => {
            forgotPasswordMessage.textContent = "Password reset link sent!";
            forgotPasswordError.textContent = "";
          })
          .catch((error) => {
            forgotPasswordError.textContent = error.message;
            forgotPasswordMessage.textContent = "";
          });
      });

      // Monitor Authentication State
      auth.onAuthStateChanged((user) => {
        if (user) {
          // User is signed in
          signupBtn.style.display = "none";
          loginBtn.style.display = "none";
          profileIcon.style.display = "block";
        } else {
          // No user is signed in
          signupBtn.style.display = "inline-block";
          loginBtn.style.display = "inline-block";
          profileIcon.style.display = "none";
        }
      });

      // Close modals when clicking outside the modal content
      window.addEventListener("click", (e) => {
        if (e.target == signupModal) {
          signupModal.style.display = "none";
        }
        if (e.target == loginModal) {
          loginModal.style.display = "none";
        }
        if (e.target == forgotPasswordModal) {
          forgotPasswordModal.style.display = "none";
        }
      });
    </script>
    <script src="theme.js"></script>
  </body>
</html>
